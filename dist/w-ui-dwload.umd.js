/*!
 * w-ui-dwload v1.0.11
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("xlsx")):"function"==typeof define&&define.amd?define(["xlsx"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-ui-dwload"]=e(t.XLSX)}(this,(function(t){"use strict";function e(t){var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,Object.freeze(e)}var n=e(t),r=Array.isArray,o="object"==typeof global&&global&&global.Object===Object&&global,i="object"==typeof self&&self&&self.Object===Object&&self,u=o||i||Function("return this")(),a=u.Symbol,l=Object.prototype,c=l.hasOwnProperty,f=l.toString,s=a?a.toStringTag:void 0;var d=Object.prototype.toString;var p="[object Null]",v="[object Undefined]",h=a?a.toStringTag:void 0;function y(t){return null==t?void 0===t?v:p:h&&h in Object(t)?function(t){var e=c.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(t){}var o=f.call(t);return r&&(e?t[s]=n:delete t[s]),o}(t):function(t){return d.call(t)}(t)}function g(t){return null!=t&&"object"==typeof t}var b="[object Symbol]";function j(t){return"symbol"==typeof t||g(t)&&y(t)==b}var m=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,_=/^\w*$/;function w(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!j(t))||(_.test(t)||!m.test(t)||null!=e&&t in Object(e))}function O(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var x="[object AsyncFunction]",S="[object Function]",A="[object GeneratorFunction]",P="[object Proxy]";function L(t){if(!O(t))return!1;var e=y(t);return e==S||e==A||e==x||e==P}var k,E=u["__core-js_shared__"],F=(k=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+k:"";var N=Function.prototype.toString;function T(t){if(null!=t){try{return N.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var I=/^\[object .+?Constructor\]$/,z=Function.prototype,$=Object.prototype,U=z.toString,B=$.hasOwnProperty,D=RegExp("^"+U.call(B).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function X(t){return!(!O(t)||(e=t,F&&F in e))&&(L(t)?D:I).test(T(t));var e}function C(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return X(n)?n:void 0}var R=C(Object,"create");var M=Object.prototype.hasOwnProperty;var q=Object.prototype.hasOwnProperty;function V(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function J(t,e){return t===e||t!=t&&e!=e}function W(t,e){for(var n=t.length;n--;)if(J(t[n][0],e))return n;return-1}V.prototype.clear=function(){this.__data__=R?R(null):{},this.size=0},V.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},V.prototype.get=function(t){var e=this.__data__;if(R){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return M.call(e,t)?e[t]:void 0},V.prototype.has=function(t){var e=this.__data__;return R?void 0!==e[t]:q.call(e,t)},V.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=R&&void 0===e?"__lodash_hash_undefined__":e,this};var G=Array.prototype.splice;function H(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}H.prototype.clear=function(){this.__data__=[],this.size=0},H.prototype.delete=function(t){var e=this.__data__,n=W(e,t);return!(n<0)&&(n==e.length-1?e.pop():G.call(e,n,1),--this.size,!0)},H.prototype.get=function(t){var e=this.__data__,n=W(e,t);return n<0?void 0:e[n][1]},H.prototype.has=function(t){return W(this.__data__,t)>-1},H.prototype.set=function(t,e){var n=this.__data__,r=W(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};var K=C(u,"Map");function Q(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function Y(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Y.prototype.clear=function(){this.size=0,this.__data__={hash:new V,map:new(K||H),string:new V}},Y.prototype.delete=function(t){var e=Q(this,t).delete(t);return this.size-=e?1:0,e},Y.prototype.get=function(t){return Q(this,t).get(t)},Y.prototype.has=function(t){return Q(this,t).has(t)},Y.prototype.set=function(t,e){var n=Q(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};var Z="Expected a function";function tt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(Z);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var u=t.apply(this,r);return n.cache=i.set(o,u)||i,u};return n.cache=new(tt.Cache||Y),n}tt.Cache=Y;var et,nt,rt,ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,it=/\\(\\)?/g,ut=(et=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(ot,(function(t,n,r,o){e.push(r?o.replace(it,"$1"):n||t)})),e},nt=tt(et,(function(t){return 500===rt.size&&rt.clear(),t})),rt=nt.cache,nt),at=ut;function lt(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}var ct=1/0,ft=a?a.prototype:void 0,st=ft?ft.toString:void 0;function dt(t){if("string"==typeof t)return t;if(r(t))return lt(t,dt)+"";if(j(t))return st?st.call(t):"";var e=t+"";return"0"==e&&1/t==-ct?"-0":e}function pt(t){return null==t?"":dt(t)}function vt(t,e){return r(t)?t:w(t,e)?[t]:at(pt(t))}var ht=1/0;function yt(t){if("string"==typeof t||j(t))return t;var e=t+"";return"0"==e&&1/t==-ht?"-0":e}function gt(t,e){for(var n=0,r=(e=vt(e,t)).length;null!=t&&n<r;)t=t[yt(e[n++])];return n&&n==r?t:void 0}function bt(t,e,n){var r=null==t?void 0:gt(t,e);return void 0===r?n:r}var jt="[object Number]";function mt(t){return"number"==typeof t||g(t)&&y(t)==jt}function _t(){let t,e,n=new Promise((function(){t=arguments[0],e=arguments[1]}));return n.resolve=t,n.reject=e,n}function wt(t){return"[object String]"===Object.prototype.toString.call(t)}function Ot(t){return!(!wt(t)||""===t)}function xt(t){return t!=t}function St(t){let e=!1;if(Ot(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(xt(t))return!1;e=!0}return e}function At(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;St(t)||(t=10);let e=_t();return setTimeout((function(){e.resolve()}),t),e}function Pt(t){return"[object Array]"===Object.prototype.toString.call(t)}function Lt(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}var kt="[object Boolean]";function Et(t){return!0===t||!1===t||g(t)&&y(t)==kt}function Ft(t){return Et(t)}function Nt(t){return"[object Undefined]"===Object.prototype.toString.call(t)}function Tt(t){return"[object Object]"===Object.prototype.toString.call(t)}function It(t){return!!Nt(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(Tt(t)){for(let e in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!wt(t)||""!==t)}(t)||(!!function(t){return!!Pt(t)&&0===t.length}(t)||!!xt(t)))))}function zt(t){return!!Pt(t)&&(0!==t.length&&(1!==t.length||!It(t[0])))}function $t(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)}function Ut(t,e){return function(n){return t(e(n))}}var Bt=Ut(Object.getPrototypeOf,Object),Dt="[object Object]",Xt=Function.prototype,Ct=Object.prototype,Rt=Xt.toString,Mt=Ct.hasOwnProperty,qt=Rt.call(Object);function Vt(t){return g(t)&&1===t.nodeType&&!function(t){if(!g(t)||y(t)!=Dt)return!1;var e=Bt(t);if(null===e)return!0;var n=Mt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Rt.call(n)==qt}(t)}function Jt(t){return Vt(t)}function Wt(t){let e,n=Object.prototype.toString.call(t);if(e="[object Promise]"===n,e)return!0;if("[object Function]"!==n)return!1;try{e="function"!=typeof t.subscribe&&"function"==typeof t.then}catch(t){}return e}function Gt(t,e){return!!Tt(t)&&(!(!Ot(e)&&!St(e))&&e in t)}function Ht(t){var e=this.__data__=new H(t);this.size=e.size}Ht.prototype.clear=function(){this.__data__=new H,this.size=0},Ht.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Ht.prototype.get=function(t){return this.__data__.get(t)},Ht.prototype.has=function(t){return this.__data__.has(t)},Ht.prototype.set=function(t,e){var n=this.__data__;if(n instanceof H){var r=n.__data__;if(!K||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Y(r)}return n.set(t,e),this.size=n.size,this};function Kt(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Y;++e<n;)this.add(t[e])}function Qt(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function Yt(t,e){return t.has(e)}Kt.prototype.add=Kt.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Kt.prototype.has=function(t){return this.__data__.has(t)};var Zt=1,te=2;function ee(t,e,n,r,o,i){var u=n&Zt,a=t.length,l=e.length;if(a!=l&&!(u&&l>a))return!1;var c=i.get(t),f=i.get(e);if(c&&f)return c==e&&f==t;var s=-1,d=!0,p=n&te?new Kt:void 0;for(i.set(t,e),i.set(e,t);++s<a;){var v=t[s],h=e[s];if(r)var y=u?r(h,v,s,e,t,i):r(v,h,s,t,e,i);if(void 0!==y){if(y)continue;d=!1;break}if(p){if(!Qt(e,(function(t,e){if(!Yt(p,e)&&(v===t||o(v,t,n,r,i)))return p.push(e)}))){d=!1;break}}else if(v!==h&&!o(v,h,n,r,i)){d=!1;break}}return i.delete(t),i.delete(e),d}var ne=u.Uint8Array;function re(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function oe(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var ie=1,ue=2,ae="[object Boolean]",le="[object Date]",ce="[object Error]",fe="[object Map]",se="[object Number]",de="[object RegExp]",pe="[object Set]",ve="[object String]",he="[object Symbol]",ye="[object ArrayBuffer]",ge="[object DataView]",be=a?a.prototype:void 0,je=be?be.valueOf:void 0;function me(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}var _e=Object.prototype.propertyIsEnumerable,we=Object.getOwnPropertySymbols,Oe=we?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var n=-1,r=null==t?0:t.length,o=0,i=[];++n<r;){var u=t[n];e(u,n,t)&&(i[o++]=u)}return i}(we(t),(function(e){return _e.call(t,e)})))}:function(){return[]},xe=Oe;function Se(t){return g(t)&&"[object Arguments]"==y(t)}var Ae=Object.prototype,Pe=Ae.hasOwnProperty,Le=Ae.propertyIsEnumerable,ke=Se(function(){return arguments}())?Se:function(t){return g(t)&&Pe.call(t,"callee")&&!Le.call(t,"callee")},Ee=ke;var Fe="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ne=Fe&&"object"==typeof module&&module&&!module.nodeType&&module,Te=Ne&&Ne.exports===Fe?u.Buffer:void 0,Ie=(Te?Te.isBuffer:void 0)||function(){return!1},ze=9007199254740991,$e=/^(?:0|[1-9]\d*)$/;function Ue(t,e){var n=typeof t;return!!(e=null==e?ze:e)&&("number"==n||"symbol"!=n&&$e.test(t))&&t>-1&&t%1==0&&t<e}var Be=9007199254740991;function De(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Be}var Xe={};Xe["[object Float32Array]"]=Xe["[object Float64Array]"]=Xe["[object Int8Array]"]=Xe["[object Int16Array]"]=Xe["[object Int32Array]"]=Xe["[object Uint8Array]"]=Xe["[object Uint8ClampedArray]"]=Xe["[object Uint16Array]"]=Xe["[object Uint32Array]"]=!0,Xe["[object Arguments]"]=Xe["[object Array]"]=Xe["[object ArrayBuffer]"]=Xe["[object Boolean]"]=Xe["[object DataView]"]=Xe["[object Date]"]=Xe["[object Error]"]=Xe["[object Function]"]=Xe["[object Map]"]=Xe["[object Number]"]=Xe["[object Object]"]=Xe["[object RegExp]"]=Xe["[object Set]"]=Xe["[object String]"]=Xe["[object WeakMap]"]=!1;var Ce="object"==typeof exports&&exports&&!exports.nodeType&&exports,Re=Ce&&"object"==typeof module&&module&&!module.nodeType&&module,Me=Re&&Re.exports===Ce&&o.process,qe=function(){try{var t=Re&&Re.require&&Re.require("util").types;return t||Me&&Me.binding&&Me.binding("util")}catch(t){}}(),Ve=qe&&qe.isTypedArray,Je=Ve?function(t){return function(e){return t(e)}}(Ve):function(t){return g(t)&&De(t.length)&&!!Xe[y(t)]},We=Je,Ge=Object.prototype.hasOwnProperty;function He(t,e){var n=r(t),o=!n&&Ee(t),i=!n&&!o&&Ie(t),u=!n&&!o&&!i&&We(t),a=n||o||i||u,l=a?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],c=l.length;for(var f in t)!e&&!Ge.call(t,f)||a&&("length"==f||i&&("offset"==f||"parent"==f)||u&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||Ue(f,c))||l.push(f);return l}var Ke=Object.prototype;var Qe=Ut(Object.keys,Object),Ye=Object.prototype.hasOwnProperty;function Ze(t){if(n=(e=t)&&e.constructor,e!==("function"==typeof n&&n.prototype||Ke))return Qe(t);var e,n,r=[];for(var o in Object(t))Ye.call(t,o)&&"constructor"!=o&&r.push(o);return r}function tn(t){return null!=t&&De(t.length)&&!L(t)}function en(t){return tn(t)?He(t):Ze(t)}function nn(t){return function(t,e,n){var o=e(t);return r(t)?o:me(o,n(t))}(t,en,xe)}var rn=1,on=Object.prototype.hasOwnProperty;var un=C(u,"DataView"),an=C(u,"Promise"),ln=C(u,"Set"),cn=C(u,"WeakMap"),fn="[object Map]",sn="[object Promise]",dn="[object Set]",pn="[object WeakMap]",vn="[object DataView]",hn=T(un),yn=T(K),gn=T(an),bn=T(ln),jn=T(cn),mn=y;(un&&mn(new un(new ArrayBuffer(1)))!=vn||K&&mn(new K)!=fn||an&&mn(an.resolve())!=sn||ln&&mn(new ln)!=dn||cn&&mn(new cn)!=pn)&&(mn=function(t){var e=y(t),n="[object Object]"==e?t.constructor:void 0,r=n?T(n):"";if(r)switch(r){case hn:return vn;case yn:return fn;case gn:return sn;case bn:return dn;case jn:return pn}return e});var _n=mn,wn=1,On="[object Arguments]",xn="[object Array]",Sn="[object Object]",An=Object.prototype.hasOwnProperty;function Pn(t,e,n,o,i,u){var a=r(t),l=r(e),c=a?xn:_n(t),f=l?xn:_n(e),s=(c=c==On?Sn:c)==Sn,d=(f=f==On?Sn:f)==Sn,p=c==f;if(p&&Ie(t)){if(!Ie(e))return!1;a=!0,s=!1}if(p&&!s)return u||(u=new Ht),a||We(t)?ee(t,e,n,o,i,u):function(t,e,n,r,o,i,u){switch(n){case ge:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case ye:return!(t.byteLength!=e.byteLength||!i(new ne(t),new ne(e)));case ae:case le:case se:return J(+t,+e);case ce:return t.name==e.name&&t.message==e.message;case de:case ve:return t==e+"";case fe:var a=re;case pe:var l=r&ie;if(a||(a=oe),t.size!=e.size&&!l)return!1;var c=u.get(t);if(c)return c==e;r|=ue,u.set(t,e);var f=ee(a(t),a(e),r,o,i,u);return u.delete(t),f;case he:if(je)return je.call(t)==je.call(e)}return!1}(t,e,c,n,o,i,u);if(!(n&wn)){var v=s&&An.call(t,"__wrapped__"),h=d&&An.call(e,"__wrapped__");if(v||h){var y=v?t.value():t,g=h?e.value():e;return u||(u=new Ht),i(y,g,n,o,u)}}return!!p&&(u||(u=new Ht),function(t,e,n,r,o,i){var u=n&rn,a=nn(t),l=a.length;if(l!=nn(e).length&&!u)return!1;for(var c=l;c--;){var f=a[c];if(!(u?f in e:on.call(e,f)))return!1}var s=i.get(t),d=i.get(e);if(s&&d)return s==e&&d==t;var p=!0;i.set(t,e),i.set(e,t);for(var v=u;++c<l;){var h=t[f=a[c]],y=e[f];if(r)var g=u?r(y,h,f,e,t,i):r(h,y,f,t,e,i);if(!(void 0===g?h===y||o(h,y,n,r,i):g)){p=!1;break}v||(v="constructor"==f)}if(p&&!v){var b=t.constructor,j=e.constructor;b==j||!("constructor"in t)||!("constructor"in e)||"function"==typeof b&&b instanceof b&&"function"==typeof j&&j instanceof j||(p=!1)}return i.delete(t),i.delete(e),p}(t,e,n,o,i,u))}function Ln(t,e,n,r,o){return t===e||(null==t||null==e||!g(t)&&!g(e)?t!=t&&e!=e:Pn(t,e,n,r,Ln,o))}function kn(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}var En,Fn=function(t,e,n){for(var r=-1,o=Object(t),i=n(t),u=i.length;u--;){var a=i[En?u:++r];if(!1===e(o[a],a,o))break}return t};var Nn=function(t,e){return function(n,r){if(null==n)return n;if(!tn(n))return t(n,r);for(var o=n.length,i=e?o:-1,u=Object(n);(e?i--:++i<o)&&!1!==r(u[i],i,u););return n}}((function(t,e){return t&&Fn(t,e,en)})),Tn=Nn;function In(t){return t}function zn(t,e){var n;return(r(t)?kn:Tn)(t,"function"==typeof(n=e)?n:In)}var $n=1,Un=2;function Bn(t){return t==t&&!O(t)}function Dn(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}function Xn(t){var e=function(t){for(var e=en(t),n=e.length;n--;){var r=e[n],o=t[r];e[n]=[r,o,Bn(o)]}return e}(t);return 1==e.length&&e[0][2]?Dn(e[0][0],e[0][1]):function(n){return n===t||function(t,e,n,r){var o=n.length,i=o,u=!r;if(null==t)return!i;for(t=Object(t);o--;){var a=n[o];if(u&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<i;){var l=(a=n[o])[0],c=t[l],f=a[1];if(u&&a[2]){if(void 0===c&&!(l in t))return!1}else{var s=new Ht;if(r)var d=r(c,f,l,t,e,s);if(!(void 0===d?Ln(f,c,$n|Un,r,s):d))return!1}}return!0}(n,t,e)}}function Cn(t,e){return null!=t&&e in Object(t)}function Rn(t,e){return null!=t&&function(t,e,n){for(var o=-1,i=(e=vt(e,t)).length,u=!1;++o<i;){var a=yt(e[o]);if(!(u=null!=t&&n(t,a)))break;t=t[a]}return u||++o!=i?u:!!(i=null==t?0:t.length)&&De(i)&&Ue(a,i)&&(r(t)||Ee(t))}(t,e,Cn)}var Mn=1,qn=2;function Vn(t){return function(e){return null==e?void 0:e[t]}}function Jn(t){return w(t)?Vn(yt(t)):function(t){return function(e){return gt(e,t)}}(t)}function Wn(t){return"function"==typeof t?t:null==t?In:"object"==typeof t?r(t)?(e=t[0],n=t[1],w(e)&&Bn(n)?Dn(yt(e),n):function(t){var r=bt(t,e);return void 0===r&&r===n?Rn(t,e):Ln(n,r,Mn|qn)}):Xn(t):Jn(t);var e,n}function Gn(t,e){var n=-1,r=tn(t)?Array(t.length):[];return Tn(t,(function(t,o,i){r[++n]=e(t,o,i)})),r}function Hn(t,e){return(r(t)?lt:Gn)(t,Wn(e))}var Kn=Array.prototype.join;var Qn=/\s/;var Yn=/^\s+/;function Zn(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&Qn.test(t.charAt(e)););return e}(t)+1).replace(Yn,""):t}var tr=NaN,er=/^[-+]0x[0-9a-f]+$/i,nr=/^0b[01]+$/i,rr=/^0o[0-7]+$/i,or=parseInt;function ir(t){if("number"==typeof t)return t;if(j(t))return tr;if(O(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=O(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Zn(t);var n=nr.test(t);return n||rr.test(t)?or(t.slice(2),n?2:8):er.test(t)?tr:+t}var ur=1/0,ar=17976931348623157e292;function lr(t){return t?(t=ir(t))===ur||t===-ur?(t<0?-1:1)*ar:t==t?t:0:0===t?t:0}function cr(t){var e=lr(t),n=e%1;return e==e?n?e-n:e:0}function fr(t,e,n){var r=null==t?0:t.length;return r?function(t,e,n){var r=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(n=n>o?o:n)<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var i=Array(o);++r<o;)i[r]=t[r+e];return i}(t,(e=n||void 0===e?1:cr(e))<0?0:e,r):[]}function sr(t){if(!St(t))return 0;return lr(t)}function dr(t){return!!St(t)&&(t=sr(t),"number"==typeof(e=t)&&e==cr(e));var e}var pr=u.isFinite,vr=Math.min;var hr=function(t){var e=Math[t];return function(t,n){if(t=ir(t),(n=null==n?0:vr(cr(n),292))&&pr(t)){var r=(pt(t)+"e").split("e");return+((r=(pt(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}("round"),yr=hr;function gr(t){if(!St(t))return 0;t=sr(t);let e=yr(t);return"0"===String(e)?0:e}function br(t){if(!dr(t))return!1;return gr(t)>0}async function jr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,r=_t();if(!Lt(t))return r.reject("waitfunction需輸入函數f"),r;let o=async()=>{let e=t();return Wt(e)&&(e=await e),e};if(n=await o(),!0===n)return r.resolve(),r;let i=bt(e,"attemptNum",null);br(i)||(i=200);let u=bt(e,"timeInterval",null);br(u)||(u=1e3);let a=0,l=setInterval((async()=>{a+=1,n=await o(),!0===n&&(clearInterval(l),r.resolve()),a>i&&(clearInterval(l),r.reject(`exceeded attemptNum[${i}]`))}),u);return r}function mr(t,e){if(!Ot(t))return"";if(!(dr(n=e)&&gr(n)>=0))return"";var n;if(0===(e=gr(e)))return"";let r=t.length-e;return r<0&&(r=0),t.substring(r,r+e)}let _r={},wr={};function Or(t){let{tagName:e,path:n,attributes:r={},func:o}=t,i=_t();if("done"===_r[n])return i.resolve("loaded"),i;if("loading"===_r[n])return jr((()=>"done"===_r[n])).then((function(){i.resolve("loaded")})),i;_r[n]="loading";let u=document.createElement(e);return zn(r,((t,e)=>{u.setAttribute(e,t)})),r.rel&&"stylesheet"===r.rel?(u.setAttribute("href",n),setTimeout((()=>{i.resolve(u),_r[n]="done"}),1)):(u.src=n,u.addEventListener("load",(()=>{let t;Lt(o)?t=jr(o):(t=_t(),t.resolve()),t.then((()=>At(500))).then((function(){i.resolve(u),_r[n]="done"}))})),u.addEventListener("error",(()=>{i.reject(u),_r[n]="done"}))),document.getElementsByTagName("head")[0].appendChild(u),i}function xr(t){let e=_t();Pt(t)||(t=[t]),zn(t,((e,n)=>{wt(e)&&(t[n]={path:e})}));let n=(r=Hn(t,"path"),o="|",null==r?"":Kn.call(r,o));var r,o;return"done"===wr[n]?(e.resolve("loaded"),e):"loading"===wr[n]?(jr((()=>"done"===wr[n])).then((function(){e.resolve("loaded")})),e):(wr[n]="loading",zn(t,((t,e)=>{t.type||(".js"===mr(t.path,3)?t.type="js":".css"===mr(t.path,4)?t.type="css":t.type="unknow")})),function(t,e){let n=_t();if(!Pt(t)&&!Tt(t))return n.reject("rs is not an array or object"),n;let r=!1;if(Tt(t)){r=!0;let e=[];zn(t,((t,n)=>{e.push({k:n,v:t})})),t=e}Lt(e)||(e=function(t){return t});let o=-1,i=[];return t.reduce((function(t,n){return t.then((function(t){i.push(t),o+=1;let u=o,a=n;return r&&(u=n.k,a=n.v),Lt(e)?e(a,u):a}))}),Promise.resolve()).then((function(t){i.push(t),i=fr(i),n.resolve(i)})).catch((function(t){n.reject(t)})),n}(t,(t=>{let e=_t();if("js"===t.type)e=Or({tagName:"script",path:t.path,attributes:{type:"text/javascript"},func:t.func});else if("css"===t.type)e=Or({tagName:"link",path:t.path,attributes:{rel:"stylesheet"}});else{let n="invalid pathItem.type: "+t.type;console.log(n),e.reject(n)}return e})).finally((()=>{wr[n]="done"})))}function Sr(t){function e(t){t.parentNode.removeChild(t)}if(Jt(t)){return void e(t)}if(!Ot(t))return;let n=function(t){return document.querySelectorAll(t)}(t);zn(n,(function(t){e(t)}))}function Ar(){return"undefined"!=typeof window&&void 0!==window.document}function Pr(){return"undefined"!=typeof self?self:Ar()?window:"undefined"!=typeof global?global:null}async function Lr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Jt(t))return Promise.reject("invalid ele");let n=bt(e,"scale",1);if(!mt(n))return Promise.reject("opt.scale is not a number");if(n<1)return Promise.reject("opt.scale can not less then 1");let r=bt(e,"picType","image/png");if("image/jpeg"!==r&&"image/png"!==r)return Promise.reject("opt.picType is not one of image/jpeg or image/png");let o=bt(e,"toBase64",!0);if(!Et(o))return Promise.reject("opt.toBase64 is not a boolean");let i=t.cloneNode(!0),u=document.createElement("div");u.style.position="absolute",u.style.top=0,u.style.left=0,u.style.zIndex=-1,u.appendChild(i);let a=document.createElement("div");a.style.opacity=0,a.style.position="relative",a.appendChild(u),function(t,e){if(!Jt(t))return"invalid eleParent";if(wt(e))t.insertAdjacentHTML("afterbegin",e);else{if(!Jt(e))return"invalid itemChild";t.insertBefore(e,t.firstChild)}}(document.querySelector("body"),a);let l,c=Pr().htmlToImage,f={pixelRatio:n,quality:.95};return o?"image/jpeg"===r?l=await c.toJpeg(u,f):"image/png"===r&&(l=await c.toPng(u,f)):l=await c.toCanvas(u,f),Sr(a),l}var kr=a?a.isConcatSpreadable:void 0;function Er(t){return r(t)||Ee(t)||!!(kr&&t&&t[kr])}function Fr(t,e,n,r,o){var i=-1,u=t.length;for(n||(n=Er),o||(o=[]);++i<u;){var a=t[i];e>0&&n(a)?e>1?Fr(a,e-1,n,r,o):me(o,a):r||(o[o.length]=a)}return o}function Nr(){var t=arguments.length;if(!t)return[];for(var e=Array(t-1),n=arguments[0],o=t;o--;)e[o-1]=arguments[o];return me(r(n)?function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}(n):[n],Fr(e,1))}function Tr(t){if(Tt(t)){for(let e in t)return!0;return!1}return!1}function Ir(t){return t!=t}function zr(t,e){return!!(null==t?0:t.length)&&function(t,e,n){return e==e?function(t,e,n){for(var r=n-1,o=t.length;++r<o;)if(t[r]===e)return r;return-1}(t,e,n):function(t,e,n,r){for(var o=t.length,i=n+(r?1:-1);r?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,Ir,n)}(t,e,0)>-1}function $r(t,e,n){for(var r=-1,o=null==t?0:t.length;++r<o;)if(n(e,t[r]))return!0;return!1}var Ur=ln&&1/oe(new ln([,-0]))[1]==1/0?function(t){return new ln(t)}:function(){},Br=200;function Dr(t){return t&&t.length?function(t,e,n){var r=-1,o=zr,i=t.length,u=!0,a=[],l=a;if(n)u=!1,o=$r;else if(i>=Br){var c=e?null:Ur(t);if(c)return oe(c);u=!1,o=Yt,l=new Kt}else l=e?[]:a;t:for(;++r<i;){var f=t[r],s=e?e(f):f;if(f=n||0!==f?f:0,u&&s==s){for(var d=l.length;d--;)if(l[d]===s)continue t;e&&l.push(s),a.push(f)}else o(l,s,n)||(l!==a&&l.push(s),a.push(f))}return a}(t):[]}function Xr(t){if(!zt(t))return[];let e=[];return zn(t,(function(t){let n=en(t);e=[...e,...n],e=Dr(e)})),e}var Cr="[object String]";var Rr=Vn("length"),Mr=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var qr="\\ud800-\\udfff",Vr="["+qr+"]",Jr="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Wr="\\ud83c[\\udffb-\\udfff]",Gr="[^"+qr+"]",Hr="(?:\\ud83c[\\udde6-\\uddff]){2}",Kr="[\\ud800-\\udbff][\\udc00-\\udfff]",Qr="(?:"+Jr+"|"+Wr+")"+"?",Yr="[\\ufe0e\\ufe0f]?",Zr=Yr+Qr+("(?:\\u200d(?:"+[Gr,Hr,Kr].join("|")+")"+Yr+Qr+")*"),to="(?:"+[Gr+Jr+"?",Jr,Hr,Kr,Vr].join("|")+")",eo=RegExp(Wr+"(?="+Wr+")|"+to+Zr,"g");function no(t){return function(t){return Mr.test(t)}(t)?function(t){for(var e=eo.lastIndex=0;eo.test(t);)++e;return e}(t):Rr(t)}var ro="[object Map]",oo="[object Set]";function io(t){if(null==t)return 0;if(tn(t))return"string"==typeof(e=t)||!r(e)&&g(e)&&y(e)==Cr?no(t):t.length;var e,n=_n(t);return n==ro||n==oo?t.size:Ze(t).length}function uo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!zt(t))return[];if(zt(e)||(e=Xr(t)),0===io(e))return[];let r=!1;if(zn(t,(function(t){Tr(t)||(r=!0)})),r)return[];let o=bt(n,"empty",""),i=[];return zn(t,(function(t){let n=Hn(e,(function(e){return Gt(t,e)?Ft(t[e])?t[e]?"true":"false":wt(t[e])||St(t[e])?t[e]:function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Nt(t))return"";let n="";try{n=e?JSON.stringify(t,null,2):JSON.stringify(t)}catch(t){n=""}return n}(t[e]):o}));i.push(n)})),i}function ao(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!zt(t))return[];zt(e)||(e=Xr(t)),Tr(n)||(n={},zn(e,(t=>{n[t]=t})));let r=!1;return zn(t,(function(t){Tr(t)||(r=!0)})),r?[]:Nr([Hn(e,(function(t){return bt(n,t)}))],uo(t,e))}function lo(t,e){Ar()?Ot(t)?null!==navigator.userAgent.toLowerCase().match(/rv:([\d.]+)\) like gecko/)?function(t,e){window.navigator.msSaveOrOpenBlob(e,t)}(t,e):function(t,e){let n=window.URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(n)}(t,e):console.log("no filename"):console.log("no window")}function co(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function fo(t,e){var n=!0;return Tn(t,(function(t,r,o){return n=!!e(t,r,o)})),n}function so(t,e,n){var o=r(t)?co:fo;return n&&function(t,e,n){if(!O(n))return!1;var r=typeof e;return!!("number"==r?tn(n)&&Ue(e,n.length):"string"==r&&e in n)&&J(n[e],t)}(t,e,n)&&(e=void 0),o(t,Wn(e))}function po(){let t=Pr();if(Tr(bt(n,"utils")))return n;if(Tr(bt(n,"default.utils")))return bt(n,"default");if(Tr(bt(t,"XLSX.utils")))return bt(t,"XLSX");if(Tr(bt(t,"XLSX.default.utils")))return bt(t,"XLSX.default");if(Tr(bt(t,"xlsx.utils")))return bt(t,"xlsx");if(Tr(bt(t,"xlsx.default.utils")))return bt(t,"xlsx.default");throw console.log("XLSX",n,"g.XLSX",t.XLSX,"g.xlsx",t.xlsx),new Error("invalid XLSX, g.XLSX, g.xlsx")}function vo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data";if(!Pt(t)&&!Jt(t))return{error:"data is not an array or element"};Ot(e)||(e="data");let n=null,r=function(t){if(!Pt(t)&&!Jt(t))return{error:"data is not an array or element"};let e=null;try{let n=po().utils;Pt(t)?(so(t,Tr)&&(t=ao(t)),e=n.aoa_to_sheet(t)):Jt(t)&&(e=n.table_to_sheet(t,{raw:!0}))}catch(t){return{error:t}}return e}(t);return Gt(r,"error")?r:(n=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data";if(!Tt(t))return{error:"sheet is not an object"};Ot(e)||(e="data");let n=new function t(){if(!(this instanceof t))return new t;this.SheetNames=[],this.Sheets={}};return n.SheetNames.push(e),n.Sheets[e]=t,n}(r,e),Gt(n,"error"),n)}async function ho(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;zt(r)||(r=["https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"]),await xr(r);let o=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data",n=arguments.length>2?arguments[2]:void 0;if(!Ot(t)){let e="no filename";return console.log(e,t),{error:e}}if(Ot(e)||(e="data"),!Pt(n)&&!Jt(n)){let t="data is not an array or element";return console.log(t,n),{error:t}}Pt(n)&&Tr(bt(n,0,null))&&(n=ao(n));let r=vo(n,e);if(bt(r,"error"))return console.log(r.error),r.error;let o=po();if(Ar()){let e=o.write(r,{bookType:"xlsx",bookSST:!1,type:"array"});lo(t,new Blob([e]))}else o.writeFile(r,t);return"ok"}(t,e,n);return""!==bt(o,"error","")?Promise.reject(o.error):o}function yo(t,e){if(!Ar())return void console.log("no window");if(!Ot(t))return void console.log("no filename");if(!$t(e))return void console.log("no data");let n=function(t){return $t(t)?new Blob([t]):new Blob}(e);lo(t,n)}return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=bt(e,"keyFunDownloadFileById");Ot(n)||(n="downloadFileById");let r=bt(e,"keyFunUpdateLoading");Ot(r)||(r="updateLoading");let o=bt(e,"keyFunAlert");Ot(o)||(o="alert");let i=bt(e,"useDownloadStream");Ft(i)||(i=!0);let u=bt(e,"useDownloadBrowserView");Ft(u)||(u=!1);let a=bt(e,"browserViewTypes");zt(a)||(a=["text/plain","application/rtf","application/json","text/csv","text/html","text/xml","application/xml","application/pdf","image/png","image/jpg","image/jpeg","image/gif","image/bmp","image/svg+xml","image/webp","audio/mpeg","video/mpeg","video/mp4","video/webm"]);let l=bt(e,"textErrorDownloadImage");Ot(l)||(l="無法下載圖片");let c=bt(e,"textErrorDownloadTable");Ot(c)||(c="無法下載表格數據");let f=bt(e,"textErrorDownloadLtdt");Ot(f)||(f="無法下載數據");let s=bt(e,"textInvalidElePic");Ot(s)||(s="elePic非元素");let d=bt(e,"textInvalidEleName");Ot(d)||(d="eleName非元素或字串");let p=bt(e,"textInvalidEleTable");Ot(p)||(p="eleTable非元素");let v=bt(e,"textInvalidLtdt");Ot(v)||(v="ltdt非陣列");let h=bt(e,"textInvalidFileId");Ot(h)||(h="無檔案主鍵");let y=bt(e,"textInvalidKeyFilename");Ot(y)||(y="無檔案名稱主鍵");let g=bt(e,"textInvalidFilename");Ot(g)||(g="無檔案名稱");let b=bt(e,"textInvalidFileU8a");Ot(b)||(b="無檔案內容");let j=bt(e,"textInvalidFileType");Ot(j)||(j="無檔案類型");let m=bt(e,"textDownloadingFile");Ot(m)||(m="開始下載檔案");let _=bt(e,"textDownloadFileSuccessfully");Ot(_)||(_="下載檔案成功");let w=bt(e,"textDownloadFileFailed");function O(){let e=bt(t,r);if(Lt(e))return e(...arguments)}function x(){let e=bt(t,o);if(Lt(e))return e(...arguments)}return Ot(w)||(w="下載檔案失敗"),{downloadPic:async function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=bt(n,"scale");mt(r)||(r=3);let o=bt(n,"timeDelay");mt(o)||(o=500);let i=bt(n,"defName");Ot(i)||(i="pic");let u=bt(n,"useAlert");Ft(u)||(u=!0);let a=bt(n,"useUpdateLoading");Ft(a)||(a=!0),a&&(O(!0),await At(o)),await async function(t,e){if(!Jt(t))return Promise.reject(s);if(!Jt(e)&&!Ot(e))return Promise.reject(d);let n="";n=Jt(e)?bt(e,"innerText"):e,Ot(n)||(n=i);let o=`${n}.png`,u=t.style.background;"#fff"!==u&&(t.style.background="#fff");let a=await async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return zt(n)||(n=["https://cdn.jsdelivr.net/npm/html-to-image@1.11.11/dist/html-to-image.js"]),await xr(n),Lr(t,e)}(t,{scale:r});t.style.background=u,function(t,e){if(!Ar())return void console.log("no window");if(!Ot(t))return void console.log("no filename");let n=document.createElement("a");n.href=e,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n)}(o,a)}(t,e).catch((t=>{console.log(t),u&&x(l,{type:"error"})})).finally((()=>{a&&O(!1)}))},downloadTable:async function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=bt(n,"nameSheet");Ot(r)||(r="data");let o=bt(n,"timeDelay");mt(o)||(o=500);let i=bt(n,"defName");Ot(i)||(i="table");let u=bt(n,"useAlert");Ft(u)||(u=!0);let a=bt(n,"useUpdateLoading");Ft(a)||(a=!0),a&&(O(!0),await At(o)),await async function(t,e){if(!Jt(t))return Promise.reject(p);if(!Jt(e)&&!Ot(e))return Promise.reject(d);let n="";n=Jt(e)?bt(e,"innerText"):e,Ot(n)||(n=i);let o=`${n}.xlsx`;await ho(o,r,t)}(t,e).catch((t=>{console.log(t),u&&x(c,{type:"error"})})).finally((()=>{a&&O(!1)}))},downloadLtdt:async function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=bt(n,"nameSheet");Ot(r)||(r="data");let o=bt(n,"timeDelay");mt(o)||(o=500);let i=bt(n,"defName");Ot(i)||(i="table");let u=bt(n,"useAlert");Ft(u)||(u=!0);let a=bt(n,"useUpdateLoading");Ft(a)||(a=!0),a&&(O(!0),await At(o)),await async function(t,e){if(!Pt(t))return Promise.reject(v);if(!Jt(e)&&!Ot(e))return Promise.reject(d);let n="";n=Jt(e)?bt(e,"innerText"):e,Ot(n)||(n=i);let o=`${n}.xlsx`,u=ao(t);await ho(o,r,u)}(t,e).catch((t=>{console.log(t),u&&x(f,{type:"error"})})).finally((()=>{a&&O(!1)}))},downloadFile:async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=bt(o,"keyFileName");Ot(l)||(l="fileName");let c=bt(o,"timeDelay");mt(c)||(c=500);let f=bt(o,"useAlert");Ft(f)||(f=!0);let s=bt(o,"useUpdateLoading");Ft(s)||(s=!1),f&&x(`${m}: ${e.fileName}`,{type:"infor"}),s&&(O(!0),await At(c)),await async function(){Lt(r)&&r(0);let o=bt(e,"id");if(!Ot(o))return console.log(h,e),Promise.reject(h);let c=function(){let e=bt(t,n);if(Lt(e))return e(...arguments)}(o,(t=>{let{prog:e,p:n,m:o}=t;"download"===o&&Lt(r)&&r(e)}));if(Wt(c)&&(c=await c),i)return;if(!Gt(c,l))return console.log(y,c),Promise.reject(y);let f=bt(c,l,"");if(!Ot(f))return console.log(g,c),Promise.reject(g);let s=bt(c,"u8a");if(!$t(s))return console.log(b,c),Promise.reject(b);if(yo(f,s),u){let t=bt(c,"type");if(!Ot(t))return console.log(j,c),Promise.reject(j);(function(t,e){function n(t){return Pt(t)?t:[t]}if(It(t))return!1;if(0===(t=n(t)).length)return!1;if(It(t))return!1;if(0===(e=n(e)).length)return!1;for(let n=0;n<t.length;n++)for(let i=0;i<e.length;i++)if(r=t[n],o=e[i],Ln(r,o))return!0;var r,o;return!1})(t,a)&&function(t,e){let n=new Blob([t],{type:e});try{let t=window.URL.createObjectURL(n);window.open(t)}catch(t){console.log("window.URL.createObjectURL is not support for IE11",t)}}(s,t)}}().then((()=>{f&&x(`${_}: ${e.name}`)})).catch((t=>{console.log(t),f&&x(`${w}: ${e.name}`,{type:"error"})})).finally((()=>{Lt(r)&&r(null),s&&O(!1)}))}}}}));
//# sourceMappingURL=w-ui-dwload.umd.js.map
