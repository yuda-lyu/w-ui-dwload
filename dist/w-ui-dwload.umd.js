/*!
 * w-ui-dwload v1.0.13
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("xlsx")):"function"==typeof define&&define.amd?define(["xlsx"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-ui-dwload"]=e(t.XLSX)}(this,(function(t){"use strict";function e(t){var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,Object.freeze(e)}var n=e(t),r=Array.isArray,o="object"==typeof global&&global&&global.Object===Object&&global,i="object"==typeof self&&self&&self.Object===Object&&self,u=o||i||Function("return this")(),l=u.Symbol,a=Object.prototype,c=a.hasOwnProperty,f=a.toString,s=l?l.toStringTag:void 0;var d=Object.prototype.toString;var p="[object Null]",v="[object Undefined]",h=l?l.toStringTag:void 0;function y(t){return null==t?void 0===t?v:p:h&&h in Object(t)?function(t){var e=c.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(t){}var o=f.call(t);return r&&(e?t[s]=n:delete t[s]),o}(t):function(t){return d.call(t)}(t)}function g(t){return null!=t&&"object"==typeof t}var b="[object Symbol]";function j(t){return"symbol"==typeof t||g(t)&&y(t)==b}var m=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,_=/^\w*$/;function w(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!j(t))||(_.test(t)||!m.test(t)||null!=e&&t in Object(e))}function O(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var x="[object AsyncFunction]",S="[object Function]",A="[object GeneratorFunction]",P="[object Proxy]";function L(t){if(!O(t))return!1;var e=y(t);return e==S||e==A||e==x||e==P}var k,E=u["__core-js_shared__"],F=(k=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+k:"";var N=Function.prototype.toString;function z(t){if(null!=t){try{return N.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var I=/^\[object .+?Constructor\]$/,T=Function.prototype,$=Object.prototype,U=T.toString,D=$.hasOwnProperty,X=RegExp("^"+U.call(D).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function B(t){return!(!O(t)||(e=t,F&&F in e))&&(L(t)?X:I).test(z(t));var e}function C(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return B(n)?n:void 0}var R=C(Object,"create");var M=Object.prototype.hasOwnProperty;var q=Object.prototype.hasOwnProperty;function V(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function J(t,e){return t===e||t!=t&&e!=e}function W(t,e){for(var n=t.length;n--;)if(J(t[n][0],e))return n;return-1}V.prototype.clear=function(){this.__data__=R?R(null):{},this.size=0},V.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},V.prototype.get=function(t){var e=this.__data__;if(R){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return M.call(e,t)?e[t]:void 0},V.prototype.has=function(t){var e=this.__data__;return R?void 0!==e[t]:q.call(e,t)},V.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=R&&void 0===e?"__lodash_hash_undefined__":e,this};var G=Array.prototype.splice;function H(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}H.prototype.clear=function(){this.__data__=[],this.size=0},H.prototype.delete=function(t){var e=this.__data__,n=W(e,t);return!(n<0)&&(n==e.length-1?e.pop():G.call(e,n,1),--this.size,!0)},H.prototype.get=function(t){var e=this.__data__,n=W(e,t);return n<0?void 0:e[n][1]},H.prototype.has=function(t){return W(this.__data__,t)>-1},H.prototype.set=function(t,e){var n=this.__data__,r=W(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};var K=C(u,"Map");function Q(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function Y(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Y.prototype.clear=function(){this.size=0,this.__data__={hash:new V,map:new(K||H),string:new V}},Y.prototype.delete=function(t){var e=Q(this,t).delete(t);return this.size-=e?1:0,e},Y.prototype.get=function(t){return Q(this,t).get(t)},Y.prototype.has=function(t){return Q(this,t).has(t)},Y.prototype.set=function(t,e){var n=Q(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};var Z="Expected a function";function tt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(Z);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var u=t.apply(this,r);return n.cache=i.set(o,u)||i,u};return n.cache=new(tt.Cache||Y),n}tt.Cache=Y;var et,nt,rt,ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,it=/\\(\\)?/g,ut=(et=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(ot,(function(t,n,r,o){e.push(r?o.replace(it,"$1"):n||t)})),e},nt=tt(et,(function(t){return 500===rt.size&&rt.clear(),t})),rt=nt.cache,nt),lt=ut;function at(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}var ct=1/0,ft=l?l.prototype:void 0,st=ft?ft.toString:void 0;function dt(t){if("string"==typeof t)return t;if(r(t))return at(t,dt)+"";if(j(t))return st?st.call(t):"";var e=t+"";return"0"==e&&1/t==-ct?"-0":e}function pt(t){return null==t?"":dt(t)}function vt(t,e){return r(t)?t:w(t,e)?[t]:lt(pt(t))}var ht=1/0;function yt(t){if("string"==typeof t||j(t))return t;var e=t+"";return"0"==e&&1/t==-ht?"-0":e}function gt(t,e){for(var n=0,r=(e=vt(e,t)).length;null!=t&&n<r;)t=t[yt(e[n++])];return n&&n==r?t:void 0}function bt(t,e,n){var r=null==t?void 0:gt(t,e);return void 0===r?n:r}var jt="[object Number]";function mt(t){return"number"==typeof t||g(t)&&y(t)==jt}function _t(){let t,e,n=new Promise((function(){t=arguments[0],e=arguments[1]}));return n.resolve=t,n.reject=e,n}function wt(t){return"[object String]"===Object.prototype.toString.call(t)}function Ot(t){return!(!wt(t)||""===t)}function xt(t){return t!=t}function St(t){let e=!1;if(Ot(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(xt(t))return!1;e=!0}return e}function At(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;St(t)||(t=10);let e=_t();return setTimeout((function(){e.resolve()}),t),e}function Pt(t){return"[object Array]"===Object.prototype.toString.call(t)}function Lt(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}var kt="[object Boolean]";function Et(t){return!0===(e=t)||!1===e||g(e)&&y(e)==kt;var e}function Ft(t){return"[object Undefined]"===Object.prototype.toString.call(t)}function Nt(t){return"[object Object]"===Object.prototype.toString.call(t)}function zt(t){return!!Ft(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!function(t){if(Nt(t)){for(let e in t)return!1;return!0}return!1}(t)||(!!function(t){return!(!wt(t)||""!==t)}(t)||(!!function(t){return!!Pt(t)&&0===t.length}(t)||!!xt(t)))))}function It(t){return!!Pt(t)&&(0!==t.length&&(1!==t.length||!zt(t[0])))}function Tt(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)}function $t(t,e){return function(n){return t(e(n))}}var Ut=$t(Object.getPrototypeOf,Object),Dt="[object Object]",Xt=Function.prototype,Bt=Object.prototype,Ct=Xt.toString,Rt=Bt.hasOwnProperty,Mt=Ct.call(Object);function qt(t){return g(t)&&1===t.nodeType&&!function(t){if(!g(t)||y(t)!=Dt)return!1;var e=Ut(t);if(null===e)return!0;var n=Rt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Ct.call(n)==Mt}(t)}function Vt(t){return qt(t)}function Jt(t){let e,n=Object.prototype.toString.call(t);if(e="[object Promise]"===n,e)return!0;if("[object Function]"!==n)return!1;try{e="function"!=typeof t.subscribe&&"function"==typeof t.then}catch(t){}return e}function Wt(t,e){return!!Nt(t)&&(!(!Ot(e)&&!St(e))&&e in t)}function Gt(t){var e=this.__data__=new H(t);this.size=e.size}Gt.prototype.clear=function(){this.__data__=new H,this.size=0},Gt.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Gt.prototype.get=function(t){return this.__data__.get(t)},Gt.prototype.has=function(t){return this.__data__.has(t)},Gt.prototype.set=function(t,e){var n=this.__data__;if(n instanceof H){var r=n.__data__;if(!K||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Y(r)}return n.set(t,e),this.size=n.size,this};function Ht(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Y;++e<n;)this.add(t[e])}function Kt(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function Qt(t,e){return t.has(e)}Ht.prototype.add=Ht.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},Ht.prototype.has=function(t){return this.__data__.has(t)};var Yt=1,Zt=2;function te(t,e,n,r,o,i){var u=n&Yt,l=t.length,a=e.length;if(l!=a&&!(u&&a>l))return!1;var c=i.get(t),f=i.get(e);if(c&&f)return c==e&&f==t;var s=-1,d=!0,p=n&Zt?new Ht:void 0;for(i.set(t,e),i.set(e,t);++s<l;){var v=t[s],h=e[s];if(r)var y=u?r(h,v,s,e,t,i):r(v,h,s,t,e,i);if(void 0!==y){if(y)continue;d=!1;break}if(p){if(!Kt(e,(function(t,e){if(!Qt(p,e)&&(v===t||o(v,t,n,r,i)))return p.push(e)}))){d=!1;break}}else if(v!==h&&!o(v,h,n,r,i)){d=!1;break}}return i.delete(t),i.delete(e),d}var ee=u.Uint8Array;function ne(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function re(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var oe=1,ie=2,ue="[object Boolean]",le="[object Date]",ae="[object Error]",ce="[object Map]",fe="[object Number]",se="[object RegExp]",de="[object Set]",pe="[object String]",ve="[object Symbol]",he="[object ArrayBuffer]",ye="[object DataView]",ge=l?l.prototype:void 0,be=ge?ge.valueOf:void 0;function je(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}var me=Object.prototype.propertyIsEnumerable,_e=Object.getOwnPropertySymbols,we=_e?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var n=-1,r=null==t?0:t.length,o=0,i=[];++n<r;){var u=t[n];e(u,n,t)&&(i[o++]=u)}return i}(_e(t),(function(e){return me.call(t,e)})))}:function(){return[]},Oe=we;function xe(t){return g(t)&&"[object Arguments]"==y(t)}var Se=Object.prototype,Ae=Se.hasOwnProperty,Pe=Se.propertyIsEnumerable,Le=xe(function(){return arguments}())?xe:function(t){return g(t)&&Ae.call(t,"callee")&&!Pe.call(t,"callee")},ke=Le;var Ee="object"==typeof exports&&exports&&!exports.nodeType&&exports,Fe=Ee&&"object"==typeof module&&module&&!module.nodeType&&module,Ne=Fe&&Fe.exports===Ee?u.Buffer:void 0,ze=(Ne?Ne.isBuffer:void 0)||function(){return!1},Ie=9007199254740991,Te=/^(?:0|[1-9]\d*)$/;function $e(t,e){var n=typeof t;return!!(e=null==e?Ie:e)&&("number"==n||"symbol"!=n&&Te.test(t))&&t>-1&&t%1==0&&t<e}var Ue=9007199254740991;function De(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Ue}var Xe={};Xe["[object Float32Array]"]=Xe["[object Float64Array]"]=Xe["[object Int8Array]"]=Xe["[object Int16Array]"]=Xe["[object Int32Array]"]=Xe["[object Uint8Array]"]=Xe["[object Uint8ClampedArray]"]=Xe["[object Uint16Array]"]=Xe["[object Uint32Array]"]=!0,Xe["[object Arguments]"]=Xe["[object Array]"]=Xe["[object ArrayBuffer]"]=Xe["[object Boolean]"]=Xe["[object DataView]"]=Xe["[object Date]"]=Xe["[object Error]"]=Xe["[object Function]"]=Xe["[object Map]"]=Xe["[object Number]"]=Xe["[object Object]"]=Xe["[object RegExp]"]=Xe["[object Set]"]=Xe["[object String]"]=Xe["[object WeakMap]"]=!1;var Be="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ce=Be&&"object"==typeof module&&module&&!module.nodeType&&module,Re=Ce&&Ce.exports===Be&&o.process,Me=function(){try{var t=Ce&&Ce.require&&Ce.require("util").types;return t||Re&&Re.binding&&Re.binding("util")}catch(t){}}(),qe=Me&&Me.isTypedArray,Ve=qe?function(t){return function(e){return t(e)}}(qe):function(t){return g(t)&&De(t.length)&&!!Xe[y(t)]},Je=Ve,We=Object.prototype.hasOwnProperty;function Ge(t,e){var n=r(t),o=!n&&ke(t),i=!n&&!o&&ze(t),u=!n&&!o&&!i&&Je(t),l=n||o||i||u,a=l?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],c=a.length;for(var f in t)!e&&!We.call(t,f)||l&&("length"==f||i&&("offset"==f||"parent"==f)||u&&("buffer"==f||"byteLength"==f||"byteOffset"==f)||$e(f,c))||a.push(f);return a}var He=Object.prototype;var Ke=$t(Object.keys,Object),Qe=Object.prototype.hasOwnProperty;function Ye(t){if(n=(e=t)&&e.constructor,e!==("function"==typeof n&&n.prototype||He))return Ke(t);var e,n,r=[];for(var o in Object(t))Qe.call(t,o)&&"constructor"!=o&&r.push(o);return r}function Ze(t){return null!=t&&De(t.length)&&!L(t)}function tn(t){return Ze(t)?Ge(t):Ye(t)}function en(t){return function(t,e,n){var o=e(t);return r(t)?o:je(o,n(t))}(t,tn,Oe)}var nn=1,rn=Object.prototype.hasOwnProperty;var on=C(u,"DataView"),un=C(u,"Promise"),ln=C(u,"Set"),an=C(u,"WeakMap"),cn="[object Map]",fn="[object Promise]",sn="[object Set]",dn="[object WeakMap]",pn="[object DataView]",vn=z(on),hn=z(K),yn=z(un),gn=z(ln),bn=z(an),jn=y;(on&&jn(new on(new ArrayBuffer(1)))!=pn||K&&jn(new K)!=cn||un&&jn(un.resolve())!=fn||ln&&jn(new ln)!=sn||an&&jn(new an)!=dn)&&(jn=function(t){var e=y(t),n="[object Object]"==e?t.constructor:void 0,r=n?z(n):"";if(r)switch(r){case vn:return pn;case hn:return cn;case yn:return fn;case gn:return sn;case bn:return dn}return e});var mn=jn,_n=1,wn="[object Arguments]",On="[object Array]",xn="[object Object]",Sn=Object.prototype.hasOwnProperty;function An(t,e,n,o,i,u){var l=r(t),a=r(e),c=l?On:mn(t),f=a?On:mn(e),s=(c=c==wn?xn:c)==xn,d=(f=f==wn?xn:f)==xn,p=c==f;if(p&&ze(t)){if(!ze(e))return!1;l=!0,s=!1}if(p&&!s)return u||(u=new Gt),l||Je(t)?te(t,e,n,o,i,u):function(t,e,n,r,o,i,u){switch(n){case ye:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case he:return!(t.byteLength!=e.byteLength||!i(new ee(t),new ee(e)));case ue:case le:case fe:return J(+t,+e);case ae:return t.name==e.name&&t.message==e.message;case se:case pe:return t==e+"";case ce:var l=ne;case de:var a=r&oe;if(l||(l=re),t.size!=e.size&&!a)return!1;var c=u.get(t);if(c)return c==e;r|=ie,u.set(t,e);var f=te(l(t),l(e),r,o,i,u);return u.delete(t),f;case ve:if(be)return be.call(t)==be.call(e)}return!1}(t,e,c,n,o,i,u);if(!(n&_n)){var v=s&&Sn.call(t,"__wrapped__"),h=d&&Sn.call(e,"__wrapped__");if(v||h){var y=v?t.value():t,g=h?e.value():e;return u||(u=new Gt),i(y,g,n,o,u)}}return!!p&&(u||(u=new Gt),function(t,e,n,r,o,i){var u=n&nn,l=en(t),a=l.length;if(a!=en(e).length&&!u)return!1;for(var c=a;c--;){var f=l[c];if(!(u?f in e:rn.call(e,f)))return!1}var s=i.get(t),d=i.get(e);if(s&&d)return s==e&&d==t;var p=!0;i.set(t,e),i.set(e,t);for(var v=u;++c<a;){var h=t[f=l[c]],y=e[f];if(r)var g=u?r(y,h,f,e,t,i):r(h,y,f,t,e,i);if(!(void 0===g?h===y||o(h,y,n,r,i):g)){p=!1;break}v||(v="constructor"==f)}if(p&&!v){var b=t.constructor,j=e.constructor;b==j||!("constructor"in t)||!("constructor"in e)||"function"==typeof b&&b instanceof b&&"function"==typeof j&&j instanceof j||(p=!1)}return i.delete(t),i.delete(e),p}(t,e,n,o,i,u))}function Pn(t,e,n,r,o){return t===e||(null==t||null==e||!g(t)&&!g(e)?t!=t&&e!=e:An(t,e,n,r,Pn,o))}function Ln(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}var kn,En=function(t,e,n){for(var r=-1,o=Object(t),i=n(t),u=i.length;u--;){var l=i[kn?u:++r];if(!1===e(o[l],l,o))break}return t};var Fn=function(t,e){return function(n,r){if(null==n)return n;if(!Ze(n))return t(n,r);for(var o=n.length,i=e?o:-1,u=Object(n);(e?i--:++i<o)&&!1!==r(u[i],i,u););return n}}((function(t,e){return t&&En(t,e,tn)})),Nn=Fn;function zn(t){return t}function In(t,e){var n;return(r(t)?Ln:Nn)(t,"function"==typeof(n=e)?n:zn)}var Tn=1,$n=2;function Un(t){return t==t&&!O(t)}function Dn(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}function Xn(t){var e=function(t){for(var e=tn(t),n=e.length;n--;){var r=e[n],o=t[r];e[n]=[r,o,Un(o)]}return e}(t);return 1==e.length&&e[0][2]?Dn(e[0][0],e[0][1]):function(n){return n===t||function(t,e,n,r){var o=n.length,i=o,u=!r;if(null==t)return!i;for(t=Object(t);o--;){var l=n[o];if(u&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++o<i;){var a=(l=n[o])[0],c=t[a],f=l[1];if(u&&l[2]){if(void 0===c&&!(a in t))return!1}else{var s=new Gt;if(r)var d=r(c,f,a,t,e,s);if(!(void 0===d?Pn(f,c,Tn|$n,r,s):d))return!1}}return!0}(n,t,e)}}function Bn(t,e){return null!=t&&e in Object(t)}function Cn(t,e){return null!=t&&function(t,e,n){for(var o=-1,i=(e=vt(e,t)).length,u=!1;++o<i;){var l=yt(e[o]);if(!(u=null!=t&&n(t,l)))break;t=t[l]}return u||++o!=i?u:!!(i=null==t?0:t.length)&&De(i)&&$e(l,i)&&(r(t)||ke(t))}(t,e,Bn)}var Rn=1,Mn=2;function qn(t){return function(e){return null==e?void 0:e[t]}}function Vn(t){return w(t)?qn(yt(t)):function(t){return function(e){return gt(e,t)}}(t)}function Jn(t){return"function"==typeof t?t:null==t?zn:"object"==typeof t?r(t)?(e=t[0],n=t[1],w(e)&&Un(n)?Dn(yt(e),n):function(t){var r=bt(t,e);return void 0===r&&r===n?Cn(t,e):Pn(n,r,Rn|Mn)}):Xn(t):Vn(t);var e,n}function Wn(t,e){var n=-1,r=Ze(t)?Array(t.length):[];return Nn(t,(function(t,o,i){r[++n]=e(t,o,i)})),r}function Gn(t,e){return(r(t)?at:Wn)(t,Jn(e))}var Hn=Array.prototype.join;var Kn=/\s/;var Qn=/^\s+/;function Yn(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&Kn.test(t.charAt(e)););return e}(t)+1).replace(Qn,""):t}var Zn=NaN,tr=/^[-+]0x[0-9a-f]+$/i,er=/^0b[01]+$/i,nr=/^0o[0-7]+$/i,rr=parseInt;function or(t){if("number"==typeof t)return t;if(j(t))return Zn;if(O(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=O(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Yn(t);var n=er.test(t);return n||nr.test(t)?rr(t.slice(2),n?2:8):tr.test(t)?Zn:+t}var ir=1/0,ur=17976931348623157e292;function lr(t){return t?(t=or(t))===ir||t===-ir?(t<0?-1:1)*ur:t==t?t:0:0===t?t:0}function ar(t){var e=lr(t),n=e%1;return e==e?n?e-n:e:0}function cr(t,e,n){var r=null==t?0:t.length;return r?function(t,e,n){var r=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(n=n>o?o:n)<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var i=Array(o);++r<o;)i[r]=t[r+e];return i}(t,(e=n||void 0===e?1:ar(e))<0?0:e,r):[]}function fr(t){if(!St(t))return 0;return lr(t)}function sr(t){return!!St(t)&&(t=fr(t),"number"==typeof(e=t)&&e==ar(e));var e}var dr=u.isFinite,pr=Math.min;var vr=function(t){var e=Math[t];return function(t,n){if(t=or(t),(n=null==n?0:pr(ar(n),292))&&dr(t)){var r=(pt(t)+"e").split("e");return+((r=(pt(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}("round"),hr=vr;function yr(t){if(!St(t))return 0;t=fr(t);let e=hr(t);return"0"===String(e)?0:e}function gr(t){if(!sr(t))return!1;return yr(t)>0}async function br(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,r=_t();if(!Lt(t))return r.reject("waitfunction需輸入函數f"),r;let o=async()=>{let e=t();return Jt(e)&&(e=await e),e};if(n=await o(),!0===n)return r.resolve(),r;let i=bt(e,"attemptNum",null);gr(i)||(i=200);let u=bt(e,"timeInterval",null);gr(u)||(u=1e3);let l=0,a=setInterval((async()=>{l+=1,n=await o(),!0===n&&(clearInterval(a),r.resolve()),l>i&&(clearInterval(a),r.reject(`exceeded attemptNum[${i}]`))}),u);return r}function jr(t,e){if(!Ot(t))return"";if(!(sr(n=e)&&yr(n)>=0))return"";var n;if(0===(e=yr(e)))return"";let r=t.length-e;return r<0&&(r=0),t.substring(r,r+e)}let mr={},_r={};function wr(t){let{tagName:e,path:n,attributes:r={},func:o}=t,i=_t();if("done"===mr[n])return i.resolve("loaded"),i;if("loading"===mr[n])return br((()=>"done"===mr[n])).then((function(){i.resolve("loaded")})),i;mr[n]="loading";let u=document.createElement(e);return In(r,((t,e)=>{u.setAttribute(e,t)})),r.rel&&"stylesheet"===r.rel?(u.setAttribute("href",n),setTimeout((()=>{i.resolve(u),mr[n]="done"}),1)):(u.src=n,u.addEventListener("load",(()=>{let t;Lt(o)?t=br(o):(t=_t(),t.resolve()),t.then((()=>At(500))).then((function(){i.resolve(u),mr[n]="done"}))})),u.addEventListener("error",(()=>{i.reject(u),mr[n]="done"}))),document.getElementsByTagName("head")[0].appendChild(u),i}function Or(t){let e=_t();Pt(t)||(t=[t]),In(t,((e,n)=>{wt(e)&&(t[n]={path:e})}));let n=(r=Gn(t,"path"),o="|",null==r?"":Hn.call(r,o));var r,o;return"done"===_r[n]?(e.resolve("loaded"),e):"loading"===_r[n]?(br((()=>"done"===_r[n])).then((function(){e.resolve("loaded")})),e):(_r[n]="loading",In(t,((t,e)=>{t.type||(".js"===jr(t.path,3)?t.type="js":".css"===jr(t.path,4)?t.type="css":t.type="unknow")})),function(t,e){let n=_t();if(!Pt(t)&&!Nt(t))return n.reject("rs is not an array or object"),n;let r=!1;if(Nt(t)){r=!0;let e=[];In(t,((t,n)=>{e.push({k:n,v:t})})),t=e}Lt(e)||(e=function(t){return t});let o=-1,i=[];return t.reduce((function(t,n){return t.then((function(t){i.push(t),o+=1;let u=o,l=n;return r&&(u=n.k,l=n.v),Lt(e)?e(l,u):l}))}),Promise.resolve()).then((function(t){i.push(t),i=cr(i),n.resolve(i)})).catch((function(t){n.reject(t)})),n}(t,(t=>{let e=_t();if("js"===t.type)e=wr({tagName:"script",path:t.path,attributes:{type:"text/javascript"},func:t.func});else if("css"===t.type)e=wr({tagName:"link",path:t.path,attributes:{rel:"stylesheet"}});else{let n="invalid pathItem.type: "+t.type;console.log(n),e.reject(n)}return e})).finally((()=>{_r[n]="done"})))}function xr(t){function e(t){t.parentNode.removeChild(t)}if(Vt(t)){return void e(t)}if(!Ot(t))return;let n=function(t){return document.querySelectorAll(t)}(t);In(n,(function(t){e(t)}))}function Sr(){return"undefined"!=typeof window&&void 0!==window.document}function Ar(){return"undefined"!=typeof self?self:Sr()?window:"undefined"!=typeof global?global:null}async function Pr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Vt(t))return Promise.reject("invalid ele");let n=bt(e,"scale",null);if(St(n)||(n=1),n=fr(n),n<1)return Promise.reject("opt.scale can not less then 1");let r=bt(e,"picType",null);"image/jpg"!==r&&"image/jpeg"!==r&&"image/png"!==r&&"svg"!==r&&(r="image/png");let o=bt(e,"toBase64",null);Et(o)||(o=!0);let i=t.cloneNode(!0),u=document.createElement("div");u.style.position="absolute",u.style.top=0,u.style.left=0,u.style.zIndex=-1,u.appendChild(i);let l=document.createElement("div");l.style.opacity=0,l.style.position="relative",l.appendChild(u),function(t,e){if(!Vt(t))return"invalid eleParent";if(wt(e))t.insertAdjacentHTML("afterbegin",e);else{if(!Vt(e))return"invalid itemChild";t.insertBefore(e,t.firstChild)}}(document.querySelector("body"),l);let a,c=Ar().snapdom,f={scale:n,quality:1,cache:"disabled"};return"image/jpg"===r||"image/jpeg"===r?a=await c.toJpg(u,f):"image/png"===r?a=await c.toPng(u,f):"svg"===r&&(a=await c.toSvg(u,f)),o&&(a=bt(a,"src","")),xr(l),a}var Lr=l?l.isConcatSpreadable:void 0;function kr(t){return r(t)||ke(t)||!!(Lr&&t&&t[Lr])}function Er(t,e,n,r,o){var i=-1,u=t.length;for(n||(n=kr),o||(o=[]);++i<u;){var l=t[i];e>0&&n(l)?e>1?Er(l,e-1,n,r,o):je(o,l):r||(o[o.length]=l)}return o}function Fr(){var t=arguments.length;if(!t)return[];for(var e=Array(t-1),n=arguments[0],o=t;o--;)e[o-1]=arguments[o];return je(r(n)?function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}(n):[n],Er(e,1))}function Nr(t){if(Nt(t)){for(let e in t)return!0;return!1}return!1}function zr(t){return t!=t}function Ir(t,e){return!!(null==t?0:t.length)&&function(t,e,n){return e==e?function(t,e,n){for(var r=n-1,o=t.length;++r<o;)if(t[r]===e)return r;return-1}(t,e,n):function(t,e,n,r){for(var o=t.length,i=n+(r?1:-1);r?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,zr,n)}(t,e,0)>-1}function Tr(t,e,n){for(var r=-1,o=null==t?0:t.length;++r<o;)if(n(e,t[r]))return!0;return!1}var $r=ln&&1/re(new ln([,-0]))[1]==1/0?function(t){return new ln(t)}:function(){},Ur=200;function Dr(t){return t&&t.length?function(t,e,n){var r=-1,o=Ir,i=t.length,u=!0,l=[],a=l;if(n)u=!1,o=Tr;else if(i>=Ur){var c=e?null:$r(t);if(c)return re(c);u=!1,o=Qt,a=new Ht}else a=e?[]:l;t:for(;++r<i;){var f=t[r],s=e?e(f):f;if(f=n||0!==f?f:0,u&&s==s){for(var d=a.length;d--;)if(a[d]===s)continue t;e&&a.push(s),l.push(f)}else o(a,s,n)||(a!==l&&a.push(s),l.push(f))}return l}(t):[]}function Xr(t){if(!It(t))return[];let e=[];return In(t,(function(t){let n=tn(t);e=[...e,...n],e=Dr(e)})),e}var Br="[object String]";var Cr=qn("length"),Rr=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Mr="\\ud800-\\udfff",qr="["+Mr+"]",Vr="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Jr="\\ud83c[\\udffb-\\udfff]",Wr="[^"+Mr+"]",Gr="(?:\\ud83c[\\udde6-\\uddff]){2}",Hr="[\\ud800-\\udbff][\\udc00-\\udfff]",Kr="(?:"+Vr+"|"+Jr+")"+"?",Qr="[\\ufe0e\\ufe0f]?",Yr=Qr+Kr+("(?:\\u200d(?:"+[Wr,Gr,Hr].join("|")+")"+Qr+Kr+")*"),Zr="(?:"+[Wr+Vr+"?",Vr,Gr,Hr,qr].join("|")+")",to=RegExp(Jr+"(?="+Jr+")|"+Zr+Yr,"g");function eo(t){return function(t){return Rr.test(t)}(t)?function(t){for(var e=to.lastIndex=0;to.test(t);)++e;return e}(t):Cr(t)}var no="[object Map]",ro="[object Set]";function oo(t){if(null==t)return 0;if(Ze(t))return"string"==typeof(e=t)||!r(e)&&g(e)&&y(e)==Br?eo(t):t.length;var e,n=mn(t);return n==no||n==ro?t.size:Ye(t).length}function io(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!It(t))return[];if(It(e)||(e=Xr(t)),0===oo(e))return[];let r=!1;if(In(t,(function(t){Nr(t)||(r=!0)})),r)return[];let o=bt(n,"empty",""),i=[];return In(t,(function(t){let n=Gn(e,(function(e){return Wt(t,e)?Et(t[e])?t[e]?"true":"false":wt(t[e])||St(t[e])?t[e]:function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Ft(t))return"";let n="";try{n=e?JSON.stringify(t,null,2):JSON.stringify(t)}catch(t){n=""}return n}(t[e]):o}));i.push(n)})),i}function uo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!It(t))return[];It(e)||(e=Xr(t)),Nr(n)||(n={},In(e,(t=>{n[t]=t})));let r=!1;return In(t,(function(t){Nr(t)||(r=!0)})),r?[]:Fr([Gn(e,(function(t){return bt(n,t)}))],io(t,e))}function lo(t,e){Sr()?Ot(t)?null!==navigator.userAgent.toLowerCase().match(/rv:([\d.]+)\) like gecko/)?function(t,e){window.navigator.msSaveOrOpenBlob(e,t)}(t,e):function(t,e){let n=window.URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(n)}(t,e):console.log("no filename"):console.log("no window")}function ao(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function co(t,e){var n=!0;return Nn(t,(function(t,r,o){return n=!!e(t,r,o)})),n}function fo(t,e,n){var o=r(t)?ao:co;return n&&function(t,e,n){if(!O(n))return!1;var r=typeof e;return!!("number"==r?Ze(n)&&$e(e,n.length):"string"==r&&e in n)&&J(n[e],t)}(t,e,n)&&(e=void 0),o(t,Jn(e))}function so(){let t=Ar();if(Nr(bt(n,"utils")))return n;if(Nr(bt(n,"default.utils")))return bt(n,"default");if(Nr(bt(t,"XLSX.utils")))return bt(t,"XLSX");if(Nr(bt(t,"XLSX.default.utils")))return bt(t,"XLSX.default");if(Nr(bt(t,"xlsx.utils")))return bt(t,"xlsx");if(Nr(bt(t,"xlsx.default.utils")))return bt(t,"xlsx.default");throw console.log("XLSX",n,"g.XLSX",t.XLSX,"g.xlsx",t.xlsx),new Error("invalid XLSX, g.XLSX, g.xlsx")}function po(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data";if(!Pt(t)&&!Vt(t))return{error:"data is not an array or element"};Ot(e)||(e="data");let n=null,r=function(t){if(!Pt(t)&&!Vt(t))return{error:"data is not an array or element"};let e=null;try{let n=so().utils;Pt(t)?(fo(t,Nr)&&(t=uo(t)),e=n.aoa_to_sheet(t)):Vt(t)&&(e=n.table_to_sheet(t,{raw:!0}))}catch(t){return{error:t}}return e}(t);return Wt(r,"error")?r:(n=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data";if(!Nt(t))return{error:"sheet is not an object"};Ot(e)||(e="data");let n=new function t(){if(!(this instanceof t))return new t;this.SheetNames=[],this.Sheets={}};return n.SheetNames.push(e),n.Sheets[e]=t,n}(r,e),Wt(n,"error"),n)}async function vo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data",n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;It(r)||(r=["https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"]),await Or(r);let o=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data",n=arguments.length>2?arguments[2]:void 0;if(!Ot(t)){let e="no filename";return console.log(e,t),{error:e}}if(Ot(e)||(e="data"),!Pt(n)&&!Vt(n)){let t="data is not an array or element";return console.log(t,n),{error:t}}Pt(n)&&Nr(bt(n,0,null))&&(n=uo(n));let r=po(n,e);if(bt(r,"error"))return console.log(r.error),r.error;let o=so();if(Sr()){let e=o.write(r,{bookType:"xlsx",bookSST:!1,type:"array"});lo(t,new Blob([e]))}else o.writeFile(r,t);return"ok"}(t,e,n);return""!==bt(o,"error","")?Promise.reject(o.error):o}function ho(t,e){if(!Sr())return void console.log("no window");if(!Ot(t))return void console.log("no filename");if(!Tt(e))return void console.log("no data");let n=function(t){return Tt(t)?new Blob([t]):new Blob}(e);lo(t,n)}return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=bt(e,"keyFunDownloadFileById");Ot(n)||(n="downloadFileById");let r=bt(e,"keyFunUpdateLoading");Ot(r)||(r="updateLoading");let o=bt(e,"keyFunAlert");Ot(o)||(o="alert");let i=bt(e,"useDownloadStream");Et(i)||(i=!0);let u=bt(e,"useDownloadBrowserView");Et(u)||(u=!1);let l=bt(e,"browserViewTypes");It(l)||(l=["text/plain","application/rtf","application/json","text/csv","text/html","text/xml","application/xml","application/pdf","image/png","image/jpg","image/jpeg","image/gif","image/bmp","image/svg+xml","image/webp","audio/mpeg","video/mpeg","video/mp4","video/webm"]);let a=bt(e,"textErrorDownloadImage");Ot(a)||(a="無法下載圖片");let c=bt(e,"textErrorDownloadTable");Ot(c)||(c="無法下載表格數據");let f=bt(e,"textErrorDownloadLtdt");Ot(f)||(f="無法下載數據");let s=bt(e,"textInvalidElePic");Ot(s)||(s="elePic非元素");let d=bt(e,"textInvalidEleName");Ot(d)||(d="eleName非元素或字串");let p=bt(e,"textInvalidEleTable");Ot(p)||(p="eleTable非元素");let v=bt(e,"textInvalidLtdt");Ot(v)||(v="ltdt非陣列");let h=bt(e,"textInvalidFileId");Ot(h)||(h="無檔案主鍵");let y=bt(e,"textInvalidKeyFilename");Ot(y)||(y="無檔案名稱主鍵");let g=bt(e,"textInvalidFilename");Ot(g)||(g="無檔案名稱");let b=bt(e,"textInvalidFileU8a");Ot(b)||(b="無檔案內容");let j=bt(e,"textInvalidFileType");Ot(j)||(j="無檔案類型");let m=bt(e,"textDownloadingFile");Ot(m)||(m="開始下載檔案");let _=bt(e,"textDownloadFileSuccessfully");Ot(_)||(_="下載檔案成功");let w=bt(e,"textDownloadFileFailed");function O(){let e=bt(t,r);if(Lt(e))return e(...arguments)}function x(){let e=bt(t,o);if(Lt(e))return e(...arguments)}return Ot(w)||(w="下載檔案失敗"),{downloadPic:async function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=bt(n,"scale");mt(r)||(r=3);let o=bt(n,"timeDelay");mt(o)||(o=500);let i=bt(n,"defName");Ot(i)||(i="pic");let u=bt(n,"useAlert");Et(u)||(u=!0);let l=bt(n,"useUpdateLoading");Et(l)||(l=!0),l&&(O(!0),await At(o)),await async function(t,e){if(!Vt(t))return Promise.reject(s);if(!Vt(e)&&!Ot(e))return Promise.reject(d);let n="";n=Vt(e)?bt(e,"innerText"):e,Ot(n)||(n=i);let o=`${n}.png`,u=t.style.background;"#fff"!==u&&(t.style.background="#fff");let l=await async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return It(n)||(n=["https://cdn.jsdelivr.net/npm/@zumer/snapdom@1.9.14/dist/snapdom.min.js"]),await Or(n),Pr(t,e)}(t,{scale:r});t.style.background=u,function(t,e){if(!Sr())return void console.log("no window");if(!Ot(t))return void console.log("no filename");let n=document.createElement("a");n.href=e,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n)}(o,l)}(t,e).catch((t=>{console.log(t),u&&x(a,{type:"error"})})).finally((()=>{l&&O(!1)}))},downloadTable:async function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=bt(n,"nameSheet");Ot(r)||(r="data");let o=bt(n,"timeDelay");mt(o)||(o=500);let i=bt(n,"defName");Ot(i)||(i="table");let u=bt(n,"useAlert");Et(u)||(u=!0);let l=bt(n,"useUpdateLoading");Et(l)||(l=!0),l&&(O(!0),await At(o)),await async function(t,e){if(!Vt(t))return Promise.reject(p);if(!Vt(e)&&!Ot(e))return Promise.reject(d);let n="";n=Vt(e)?bt(e,"innerText"):e,Ot(n)||(n=i);let o=`${n}.xlsx`;await vo(o,r,t)}(t,e).catch((t=>{console.log(t),u&&x(c,{type:"error"})})).finally((()=>{l&&O(!1)}))},downloadLtdt:async function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=bt(n,"nameSheet");Ot(r)||(r="data");let o=bt(n,"timeDelay");mt(o)||(o=500);let i=bt(n,"defName");Ot(i)||(i="table");let u=bt(n,"useAlert");Et(u)||(u=!0);let l=bt(n,"useUpdateLoading");Et(l)||(l=!0),l&&(O(!0),await At(o)),await async function(t,e){if(!Pt(t))return Promise.reject(v);if(!Vt(e)&&!Ot(e))return Promise.reject(d);let n="";n=Vt(e)?bt(e,"innerText"):e,Ot(n)||(n=i);let o=`${n}.xlsx`,u=uo(t);await vo(o,r,u)}(t,e).catch((t=>{console.log(t),u&&x(f,{type:"error"})})).finally((()=>{l&&O(!1)}))},downloadFile:async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=bt(o,"keyFileName");Ot(a)||(a="fileName");let c=bt(o,"timeDelay");mt(c)||(c=500);let f=bt(o,"useAlert");Et(f)||(f=!0);let s=bt(o,"useUpdateLoading");Et(s)||(s=!1),f&&x(`${m}: ${e.fileName}`,{type:"infor"}),s&&(O(!0),await At(c)),await async function(){Lt(r)&&r(0);let o=bt(e,"id");if(!Ot(o))return console.log(h,e),Promise.reject(h);let c=function(){let e=bt(t,n);if(Lt(e))return e(...arguments)}(o,(t=>{let{prog:e,p:n,m:o}=t;"download"===o&&Lt(r)&&r(e)}));if(Jt(c)&&(c=await c),i)return;if(!Wt(c,a))return console.log(y,c),Promise.reject(y);let f=bt(c,a,"");if(!Ot(f))return console.log(g,c),Promise.reject(g);let s=bt(c,"u8a");if(!Tt(s))return console.log(b,c),Promise.reject(b);if(ho(f,s),u){let t=bt(c,"type");if(!Ot(t))return console.log(j,c),Promise.reject(j);(function(t,e){function n(t){return Pt(t)?t:[t]}if(zt(t))return!1;if(0===(t=n(t)).length)return!1;if(zt(t))return!1;if(0===(e=n(e)).length)return!1;for(let n=0;n<t.length;n++)for(let i=0;i<e.length;i++)if(r=t[n],o=e[i],Pn(r,o))return!0;var r,o;return!1})(t,l)&&function(t,e){let n=new Blob([t],{type:e});try{let t=window.URL.createObjectURL(n);window.open(t)}catch(t){console.log("window.URL.createObjectURL is not support for IE11",t)}}(s,t)}}().then((()=>{f&&!i&&x(`${_}: ${e.name}`)})).catch((t=>{console.log(t),f&&x(`${w}: ${e.name}`,{type:"error"})})).finally((()=>{Lt(r)&&r(null),s&&O(!1)}))}}}}));
//# sourceMappingURL=w-ui-dwload.umd.js.map
